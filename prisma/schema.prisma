generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "sqlite"
}

enum Role {
  ADMIN
  MEMBER
}

model User {
  id                String    @id @default(ulid())
  name              String
  email             String    @unique
  password_hash     String
  role              Role      @default(MEMBER)
  created_at        DateTime  @default(now())
  validatedCheckIns CheckIn?  @relation("AdminValidatedCheckIns")
  checkIns          CheckIn[] @relation("UsersCheckIns")

  @@map("users")
}

model Gym {
  id          String    @id @default(ulid())
  name        String
  description String?
  phone       String?
  latitude    Decimal
  longitude   Decimal
  created_at  DateTime  @default(now())
  checkIns    CheckIn[]

  @@map("gyms")
}

model CheckIn {
  id              String    @id @default(ulid())
  createdAt       DateTime  @default(now())
  validated_at    DateTime?
  user_id         String
  gym_id          String
  validated_by_id String?   @unique
  admin           User?     @relation("AdminValidatedCheckIns", fields: [validated_by_id], references: [id])
  user            User      @relation("UsersCheckIns", fields: [user_id], references: [id])
  gym             Gym       @relation(fields: [gym_id], references: [id])

  @@map("check_ins")
}
